/*! jquery.db 2014-01-04 */

!function(jQuery){"use strict";function a(a,b){this.db=a,this.tableName=b,this.maxResults=void 0,this.firstResult=0,this.restrictions=[],this.order=[]}function b(a,c){b.prototype.isAscending=!0,this.property=a,void 0!==c&&(this.isAscending=c)}function c(a,b){c.prototype.args=[],this.expr=a,void 0!==b&&(this.args=b)}function d(a){c.prototype.message="JQuery Database Exception",void 0!==a&&(this.message=a)}function e(a){e.prototype.migrations={},this.restriction=jQuery.db.restriction,this.database=a}a.prototype.setMaxResults=function(a){return this.maxResults=a,this},a.prototype.setFirstResult=function(a){return this.firstResult=a,this},a.prototype.addOrder=function(a){return this.order.push(a),this},a.prototype.add=function(a){return this.restrictions.push(a),this},a.prototype.list=function(a,b){var c="SELECT _ROWID_, * FROM "+this.tableName;return this._executeCriteria(c,void 0,a,b),this},a.prototype.count=function(a,b){var c="SELECT COUNT(*) AS count FROM "+this.tableName;return this._executeCriteria(c,void 0,a,b),this},a.prototype.update=function(a,b,c){var d=[],e=[];jQuery.each(a,function(a,b){d.push(b),e.push(a+" = ?")});var f="UPDATE "+this.tableName+" SET "+e.join(",");return this._executeCriteria(f,d,b,c),this},a.prototype.destroy=function(a,b){var c="DELETE FROM "+this.tableName;return this._executeCriteria(c,void 0,a,b),this},a.prototype._getWhereClause=function(a){var b=[];return jQuery.each(this.restrictions,function(c,d){b.push(d.expr);var e;for(e=0;e<d.args.length;e+=1)a.push(d.args[e])}),b.join(" AND ")},a.prototype._executeCriteria=function(a,b,c,d){if(b=b||[],this.restrictions.length>0){var e=this._getWhereClause(b);a=a+" WHERE "+e}this.order.length>0&&(jQuery.each(this.order,function(){}),a=a+" ORDER BY "+this.order.join(",")),"number"==typeof this.maxResults&&(a=a+" LIMIT "+this.maxResults),"number"==typeof this.firstResult&&this.firstResult>0&&(a=a+" OFFSET "+this.firstResult);var f=function(e){e.executeSql(a,b,c,d)};this.db.database.transaction(f)},b.prototype.toString=function(){var a;return a=this.isAscending?"ASC":"DESC",this.property+" "+a},d.prototype.toString=function(){return this.message},e.prototype.addVersionMigration=function(a,b,c){if(!this.database.changeVersion)throw new d("Version changes not possible in this browser version.");return this.migrations[a+":"+b]=c,this},e.prototype.getVersion=function(){return this.database.version},e.prototype.changeVersion=function(a,b,c){if(!this.database.changeVersion)throw new d("Version changes not possible in this browser version.");var e=this.getVersion(),f=e+":"+a;if(!this.migrations.hasOwnProperty(f))throw new d("Migration not found ["+e+" -> "+a+"]");var g=this.migrations[f];return this.database.changeVersion(e,a,g,c,b),this},e.prototype.tables=function(a){var b=function(b,c){var d,e,f=[];for(e=c.rows.length,d=0;e>d;d+=1){var g=c.rows.item(d);f.push(g.name)}"function"==typeof a&&a(f)},c="SELECT name FROM sqlite_master WHERE type = ?",e=function(a,b){throw new d(b.message+" ["+b.code+"]")};return this._execute(c,["table"],b,e),this},e.prototype.createTable=function(a){a=a||{};var b=a.name,c=[];jQuery.each(a.columns,function(a,b){if("object"==typeof b){var d=b.name;b.hasOwnProperty("type")&&(d=d+" "+b.type),b.hasOwnProperty("constraint")&&(d=d+" "+b.constraint),c.push(d)}else c.push(b)});var d;a.hasOwnProperty("dropOrIgnore")&&("drop"===a.dropOrIgnore.toLowerCase()?d="drop":"ignore"===a.dropOrIgnore.toLowerCase()&&(d="ignore"));var e;a.hasOwnProperty("done")&&(e=a.done);var f;a.hasOwnProperty("fail")&&(f=a.fail);var g="CREATE TABLE ";return"ignore"===d&&(g+="IF NOT EXISTS "),a.hasOwnProperty("constraints")&&jQuery.each(a.constraints,function(a,b){c.push(b)}),g=g+b+" ("+c.join(",")+")","drop"===d&&this._execute("DROP TABLE IF EXISTS "+b,[]),this._execute(g,[],e,f),this},e.prototype.dropTable=function(a){a=a||{};var b,c=a.name,d=a.hasOwnProperty("ignore")&&a.ignore;a.hasOwnProperty("done")&&(b=a.done);var e;a.hasOwnProperty("fail")&&(e=a.fail);var f="DROP TABLE ";return d&&(f+="IF EXISTS "),f+=c,this._execute(f,[],b,e),this},e.prototype.insert=function(a,b){var c=[],d=[],e=[];jQuery.each(b.data,function(a,b){e.push("?"),c.push(b),d.push(a)});var f;b.hasOwnProperty("done")&&(f=b.done);var g;b.hasOwnProperty("fail")&&(g=b.fail);var h="INSERT INTO "+a+" ("+d.join(",")+") VALUES ("+e.join(",")+")";return this._execute(h,c,f,g),this},e.prototype.criteria=function(b){return new a(this,b)},e.prototype._execute=function(a,b,c,d){var e=function(e){b=b||[],e.executeSql(a,b,c,d)};this.database.transaction(e)},jQuery.db=function(a,b,c,d,f){var g;if(window.openDatabase){var h=window.openDatabase(a,b,c,d,function(a){if("undefined"!=typeof f){var b=new e(a);f(b)}});g=h?new e(h):void 0}else g=void 0;return g},jQuery.db.order=function(a,c){return new b(a,c)},jQuery.extend(jQuery.db.order,{asc:function(a){return jQuery.db.order(a,!0)},desc:function(a){return jQuery.db.order(a,!1)}}),jQuery.db.restriction=function(a,b){return new c(a,b)},jQuery.extend(jQuery.db.restriction,{allEq:function(a){var b=[],d=[];return jQuery.each(a,function(a,c){b.push(a+" = ?"),d.push(c)}),new c("("+b.join(" AND ")+")",d)},and:function(a,b){var d=[],e=a._getWhereClause(d),f=b._getWhereClause(d);return new c("("+e+") AND ("+f+")",d)},between:function(a,b,d){return new c(a+" BETWEEN ? AND ?",[b,d])},eq:function(a,b){return new c(a+" = ?",[b])},eqProperty:function(a,b){return new c(a+" = "+b)},ge:function(a,b){return new c(a+" >= ?",[b])},geProperty:function(a,b){return new c(a+" >= "+b)},gt:function(a,b){return new c(a+" > ?",[b])},gtProperty:function(a,b){return new c(a+" > "+b)},idEq:function(a){return new c("_ROWID_ = ?",[a])},"in":function(a,b){var d=[];return jQuery.each(b,function(){d.push("?")}),new c(a+" in ("+d.join(", ")+")",b)},isEmpty:function(a){return new c("("+a+" IS NULL OR "+a+" = '')")},isNotEmpty:function(a){return new c("("+a+" IS NOT NULL AND "+a+" != '')")},isNotNull:function(a){return new c(a+" IS NOT NULL")},isNull:function(a){return new c(a+" IS NULL")},le:function(a,b){return new c(a+" <= ?",[b])},leProperty:function(a,b){return new c(a+" <= "+b)},like:function(a,b){return new c(a+" LIKE ?",[b])},lt:function(a,b){return new c(a+" < ?",[b])},ltProperty:function(a,b){return new c(a+" < "+b)},ne:function(a,b){return new c(a+" != ?",[b])},neProperty:function(a,b){return new c(a+" != "+b)},not:function(a){var b=[],d=a._getWhereClause(b);return new c("NOT ("+d+")",b)},or:function(a,b){var d=[],e=a._getWhereClause(d),f=b._getWhereClause(d);return new c("("+e+") OR ("+f+")",d)}})}(jQuery);
//# sourceMappingURL=build/jquery.db.0.1.3.map